<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PcapPoisoning — picoCTF Forensics</title>

  <!-- Shared CSS/JS -->
  <link rel="stylesheet" href="../../../assets/styles.css" />
  <script defer src="../../../assets/site.js"></script>
</head>

<body>
  <div class="container">
    <header>
      <div class="tagline breadcrumbs">
        <a class="crumb" href="../../../index.html">Home</a>
        <a class="crumb" href="../../index.html">picoCTF</a>
        <a class="crumb" href="../index.html">Forensics</a>
        <span class="crumb-current">PcapPoisoning</span>
      </div>

      <h1>PcapPoisoning</h1>
      <p class="badges">
        <span class="badge">PCAP</span>
        <span class="badge">Wireshark</span>
        <span class="badge">TCP Stream</span>
        <span class="badge">strings</span>
        <span class="badge">FTP</span>
      </p>

      <p class="muted">
        Goal: Find a hidden flag inside a packet capture using either quick string carving or Wireshark stream analysis.
      </p>
    </header>

    <div class="card">
      <h2>Challenge Description</h2>

      <p class="muted">Screenshot from the picoCTF challenge page:</p>

      <div class="screenshot">
        <img
          src="./pcap_poisoning/challenge.png"
          alt="Screenshot of the picoCTF challenge description for PcapPoisoning"
        />
      </div>
    </div>

    <div class="card">
      <h2>Challenge Overview</h2>
      <p>
        We’re given a <code>.pcap</code> file and told to play “hide and seek.” There are two good ways to solve it:
      </p>
      <ul>
        <li><strong>Fast method:</strong> carve strings directly out of the capture.</li>
        <li><strong>Forensics method:</strong> use Wireshark to follow the traffic and extract the flag from the right stream.</li>
      </ul>
      <p>
        I did both — because why not get the flag <em>and</em> the practice?
      </p>
    </div>

    <div class="card">
      <h2>Solution</h2>

      <h3>Method 1 (fast): strings + grep</h3>
      <p>
        First I tried the “CTF speedrun” approach: dump printable strings and search for the flag pattern.
        This worked immediately.
      </p>

      <pre><code>strings trace.pcap | grep picoCTF</code></pre>

      <div class="screenshot">
        <img
          src="./pcap_poisoning/step-01.png"
          alt="Terminal output showing strings trace.pcap grep picoCTF revealing the flag"
        />
      </div>

      <h3>Method 2 (Wireshark): follow the TCP stream</h3>
      <p>
        For the Wireshark route, I opened <code>trace.pcap</code> and started by browsing the first few packets.
        One packet had an ASCII hint: <strong>“flag is close.”</strong> Nice.
      </p>

      <div class="screenshot">
        <img
          src="./pcap_poisoning/step-02.png"
          alt="Wireshark packet list showing an ASCII hint like 'flag is close'"
        />
      </div>

      <p>
        Right next to that hint was an FTP login attempt showing:
        <code>username root</code> and <code>password toor</code>.
        That traffic is a perfect candidate for “follow the stream.”
      </p>

      <p>
        I right-clicked the FTP packet and selected:
        <strong>Follow → TCP Stream</strong>.
        The stream only contained one other packet, and that packet had the flag in plain text.
      </p>

      <div class="screenshot">
        <img
          src="./pcap_poisoning/step-03.png"
          alt="Wireshark showing the TCP stream where the flag appears"
        />
      </div>

      <h3>Flag</h3>
      <p>
        <code>picoCTF{P64P_4N4L7S1S_SU55355FUL_5b6a6061}</code>
      </p>
    </div>

    <div class="card">
      <h2>Tools Used</h2>
      <ul>
        <li><code>strings</code> + <code>grep</code> (quick extraction)</li>
        <li>Wireshark (packet inspection + Follow TCP Stream)</li>
      </ul>
    </div>

    <footer>
      <p>Write-up by Andrew Li</p>
    </footer>
  </div>
</body>
</html>
