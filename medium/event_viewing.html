<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Event-Viewing — picoCTF Forensics</title>

  <!-- Shared CSS/JS -->
  <link rel="stylesheet" href="../../../assets/styles.css" />
  <script defer src="../../../assets/site.js"></script>
</head>

<body>
  <div class="container">
    <header>
      <div class="tagline breadcrumbs">
        <a class="crumb" href="../../../index.html">Home</a>
        <a class="crumb" href="../../index.html">picoCTF</a>
        <a class="crumb" href="../index.html">Forensics</a>
        <span class="crumb-current">Event-Viewing</span>
      </div>

      <h1>Event-Viewing</h1>
      <p class="badges">
        <span class="badge">Windows Logs</span>
        <span class="badge">Event Viewer</span>
        <span class="badge">Base64</span>
      </p>

      <p class="muted">
        Goal: Investigate a suspicious Windows system using Event Viewer logs and
        recover a flag split across multiple events.
      </p>
    </header>

    <div class="card">
      <h2>Challenge Description</h2>

      <p class="muted">
        Screenshot from the picoCTF challenge page:
      </p>

      <div class="screenshot">
        <img
          src="./event-viewing/challenge.png"
          alt="Screenshot of the picoCTF Event-Viewing challenge description"
        />
      </div>
    </div>

    <div class="card">
      <h2>Challenge Overview</h2>
      <p>
        This challenge simulates a real-world incident response scenario: a user installs
        some “Totally Legit Software,” and now their system shuts down immediately after login.
      </p>
      <p>
        The challenge provides a Windows Event Log file and asks us to reconstruct what
        happened — and more importantly, extract a flag split into three parts.
        The key idea here is filtering and correlating events by <strong>Event ID</strong>
        and <strong>timestamp</strong>.
      </p>
    </div>

    <div class="card">
      <h2>Solution</h2>

      <h3>1) Flag Part 1 — Installer activity (Event ID 1033)</h3>
      <p>
        I started by creating a <strong>Custom View</strong> in Event Viewer filtering on
        <code>Event ID 1033</code>, which corresponds to Windows Installer activity.
      </p>
      <p>
        This returned a small set of events. The first one immediately stood out —
        it referenced software named <code>Totally_Legit_Software</code> and contained a
        suspicious Base64 string.
      </p>

      <div class="screenshot">
        <img
          src="./event-viewing/flag_part1.png"
          alt="Event Viewer showing Event ID 1033 with a Base64 string in the installer log"
        />
      </div>

      <p>
        Decoding the Base64 string in CyberChef revealed the <strong>first part of the flag</strong>.
        I also noted the timestamp of this event: <strong>11:55:57</strong>.
      </p>

      <h3>2) Flag Part 2 — Registry persistence (Event ID 4657)</h3>
      <p>
        Knowing the software name and timestamp, I searched the logs for the keyword
        <code>legit</code> and focused on events occurring around the same time.
      </p>
      <p>
        This led me to <code>Event ID 4657</code>, which logs registry modifications.
        The event showed a new value being added under the
        <code>Run</code> key — classic persistence behavior.
      </p>

      <div class="screenshot">
        <img
          src="./event-viewing/flag_part2.png"
          alt="Event Viewer showing Event ID 4657 with registry Run key modification and Base64 data"
        />
      </div>

      <p>
        Inside the registry value name was another Base64 string.
        Decoding it revealed the <strong>second part of the flag</strong>.
      </p>

      <h3>3) Flag Part 3 — Forced shutdowns (Event ID 1074)</h3>
      <p>
        For the final piece, I created another Custom View filtering on
        <code>Event ID 1074</code>, which records system shutdown and restart events.
      </p>
      <p>
        This view only returned four events total, making it easy to inspect each one.
        One of them contained yet another Base64 string in the shutdown comment field.
      </p>

      <div class="screenshot">
        <img
          src="./event-viewing/flag_part3.png"
          alt="Event Viewer showing Event ID 1074 with Base64-encoded shutdown comment"
        />
      </div>

      <p>
        Decoding this string gave the <strong>final part of the flag</strong>.
      </p>

      <h3>Final Flag</h3>
      <p>
        Combining all three decoded pieces:
      </p>

      <p>
        <code>picoCTF{Ev3nt_vi3wv3r_1s_a_pr3tty_us3ful_t00l_81ba3fe9}</code>
      </p>

      <p class="muted">
        This challenge is a great reminder that Windows Event Logs can tell a very
        complete story — if you know which Event IDs to look for.
      </p>
    </div>

    <div class="card">
      <h2>Tools Used</h2>
      <ul>
        <li>Windows Event Viewer (custom views + filtering)</li>
        <li>CyberChef (Base64 decoding)</li>
        <li>Keyword searching and timeline correlation</li>
      </ul>
    </div>

    <footer>
      <p>Write-up by Andrew Li</p>
    </footer>
  </div>
</body>
</html>
