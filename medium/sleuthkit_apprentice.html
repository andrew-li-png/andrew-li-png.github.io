<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>sleuthkit_apprentice — picoCTF Forensics</title>

  <!-- Shared CSS/JS -->
  <link rel="stylesheet" href="../../../assets/styles.css" />
  <script defer src="../../../assets/site.js"></script>
</head>

<body>
  <div class="container">
    <header>
      <div class="tagline breadcrumbs">
        <a class="crumb" href="../../../index.html">Home</a>
        <a class="crumb" href="../../index.html">picoCTF</a>
        <a class="crumb" href="../index.html">Forensics</a>
        <span class="crumb-current">sleuthkit_apprentice</span>
      </div>

      <h1>Sleuthkit Apprentice</h1>

      <p class="badges">
        <span class="badge">Disk Image</span>
        <span class="badge">SleuthKit</span>
        <span class="badge">mmls</span>
        <span class="badge">fls</span>
        <span class="badge">icat</span>
      </p>

      <p class="muted">
        Goal: Find the right Linux partition, walk the filesystem with SleuthKit, and extract the flag with <code>icat</code>.
      </p>
    </header>

    <div class="card">
      <h2>Challenge Description</h2>
      <p class="muted">Screenshot from the picoCTF challenge page:</p>

      <div class="screenshot">
        <img
          src="./sleuthkit_apprentice/challenge.png"
          alt="Screenshot of the picoCTF challenge description for Sleuthkit Apprentice"
        />
      </div>
    </div>

    <div class="card">
      <h2>Challenge Overview</h2>
      <p>
        This one is basically the follow-up to <code>sleuthkit_intro</code>: you’re given a disk image and told to find the flag.
        You <em>could</em> use Autopsy here, but I stuck with SleuthKit tools for practice.
      </p>
      <p>
        The flow is: identify the correct partition with <code>mmls</code>, list files with <code>fls</code>, then pull the file contents with <code>icat</code>.
      </p>
    </div>

    <div class="card">
      <h2>Solution</h2>

      <h3>1) Identify partitions with <code>mmls</code></h3>
      <p>
        First step: figure out which partition actually looks like a real Linux filesystem. The one starting at
        <code>360448</code> is the one we want.
      </p>

      <pre><code>mmls disk.flag.img</code></pre>

      <div class="screenshot">
        <img
          src="./sleuthkit_apprentice/step-01.png"
          alt="Terminal output showing mmls results with a Linux partition starting at sector offset 360448"
        />
      </div>

      <h3>2) List the filesystem root with <code>fls</code></h3>
      <p>
        Now we use that partition start sector as the offset. Running <code>fls</code> at this offset shows a normal Linux root layout.
      </p>

      <pre><code>fls -o 360448 disk.flag.img</code></pre>

      <div class="screenshot">
        <img
          src="./sleuthkit_apprentice/step-02.png"
          alt="Terminal output showing fls listing of the Linux filesystem root at offset 360448"
        />
      </div>

      <h3>3) Walk directories and extract the flag with <code>icat</code></h3>
      <p>
        From the root listing, I checked <code>root</code> (inode <code>1995</code>) and found a folder named <code>my_folder</code>.
        Inside that folder was a text file we can extract directly with <code>icat</code>.
      </p>

      <pre><code>fls -o 360448 disk.flag.img 1995
fls -o 360448 disk.flag.img 3981
icat -o 360448 disk.flag.img 2371</code></pre>

      <div class="screenshot">
        <img
          src="./sleuthkit_apprentice/step-03.png"
          alt="Terminal output showing fls into root and my_folder, then icat extracting the flag from the disk image"
        />
      </div>

      <h3>Flag</h3>
      <p>
        <code>picoCTF{by73_5urf3r_2f22df38}</code>
      </p>
    </div>

    <div class="card">
      <h2>Tools Used</h2>
      <ul>
        <li><code>gunzip</code> (decompress the downloaded disk image)</li>
        <li><code>mmls</code> (find the correct partition offset)</li>
        <li><code>fls</code> (list directories / locate target files)</li>
        <li><code>icat</code> (extract file contents by inode)</li>
      </ul>
    </div>

    <footer>
      <p>Write-up by Andrew Li</p>
    </footer>
  </div>
</body>
</html>
