<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MacroHard WeakEdge — picoCTF Forensics</title>



  <!-- Shared CSS/JS (note the ../../../ because we're 3 folders deep) -->
  <link rel="stylesheet" href="../../../assets/styles.css" />
  <script defer src="../../../assets/site.js"></script>
</head>

<body>
  <div class="container">
    <header>
      <div class="tagline breadcrumbs">
        <a class="crumb" href="../../../index.html">Home</a>
        <a class="crumb" href="../../index.html">picoCTF</a>
        <a class="crumb" href="../index.html">Forensics</a>
        <span class="crumb-current">MacroHard WeakEdge</span>
      </div>

      <h1>MacroHard WeakEdge</h1>
      <p class="badges">
        <span class="badge">picoCTF</span>
        <span class="badge">Forensics</span>
        <span class="badge">Medium</span>
      </p>

      <p class="muted">
        Goal: Find a hidden flag inside a macro-enabled PowerPoint file (<code>.pptm</code>) without falling for decoys.
      </p>
    </header>

<div class="card">
  <h2>Challenge Description</h2>

  <p class="muted">
    Screenshot from the picoCTF challenge page:
  </p>

  <div class="screenshot">
    <img
      src="./macrohard/macrohard_description.png"
      alt="Screenshot of the PicoCTF challenge description for MacroHard WeakEdge"
    />
  </div>
</div>


    <div class="card">
      <h2>Challenge Overview</h2>
      <p>
        At first, this looks like a macro challenge (it’s a <code>.pptm</code>, and the title is basically yelling “macros”).
        But the VBA code you see is a decoy. The real trick is realizing that modern Office files are basically ZIP archives,
        so you can extract the contents and hunt through the internal folders. The flag was hiding in a suspicious path:
        <code>ppt/slideMasters/hidden</code>.
      </p>
    </div>

    <div class="card">
      <h2>Solution</h2>

      <h3>1) Quick recon in PowerPoint (and spotting the decoy)</h3>
      <p>
        When I opened the PowerPoint, it had <strong>58 slides</strong>. The title slide said “Forensics is fun,” and the rest were blank.
        Since this was a <code>.pptm</code>, my first guess was that the flag was inside a macro.
      </p>
      <p>
        I enabled the Developer tab, opened the Visual Basic Editor, and found <strong>Module 1</strong>, but it was very clearly a troll.
        The code actually sets a variable that says “sorry_but_this_isn’t_it” and does nothing else.
      </p>

      <!-- Fake macro screenshot placeholder -->
      <div class="screenshot">
  <img
    src="./macrohard/decoy_macro.png"
    alt="Screenshot of the decoy macro in Module1 showing not_flag()"
  />
</div>

      <p class="muted">
        Decoy macro: looks convincing at first, but it’s basically shouting “wrong direction.”
      </p>

      <h3>2) Treat the PPTM like a container (binwalk)</h3>
      <p>
        Once the macro turned out to be fake, I switched to file-format forensics.
        Modern Office files (<code>.pptx/.pptm</code>, <code>.docx/.docm</code>, etc.) are basically ZIP containers full of XML and assets.
      </p>
      <p>
        I used <code>binwalk</code> to scan the file structure, and one entry immediately stood out:
        <code>ppt/slideMasters/hidden</code>.
        That’s not a normal-looking name for something inside a PowerPoint, so it was worth investigating.
      </p>

      <pre><code>binwalk Forensics_is_fun.pptm</code></pre>

      <p class="muted">
        You can extract it with <code>binwalk -e</code>.
      </p>

      <pre><code>Extract with binwalk:
binwalk -e Forensics_is_fun.pptm
</code></pre>


      <!-- Binwalk screenshot placeholder -->
      <div class="screenshot">
  <img
    src="./macrohard/hidden.png"
    alt="Screenshot showing binwalk output highlighting ppt/slideMasters/hidden"
    style="width:100%; height:auto; border-radius:12px; display:block;"
  />
</div>

      <h3>3) Navigate to the hidden file and recover the flag</h3>
      <p>
        After extraction, I navigated through the PowerPoint’s internal folders until I found the suspicious file:
      </p>

      <pre><code>extracted/ppt/slideMasters/hidden</code></pre>

      <p>
        Opening that file revealed a base64 encoded string. Putting this string in CyberChef and decoding it gave me the flag.  
        This is the moment the whole challenge clicks: <strong>PowerPoints are ZIPs</strong>.
      </p>

      <!-- Flag screenshot placeholder (optional) -->
       <div class="screenshot">
  <img
    src="./macrohard/flag.png"
    alt="Screenshot showing the recovered picoCTF flag from the hidden slideMasters file"
    style="width:100%; height:auto; border-radius:12px; display:block;"
  />
</div>

      <h3>Flag</h3>
      <p>
        <code>picoCTF{D1d_u_kn0w_ppts_r_z1p5}</code>
      </p>

      <p class="muted">
        Lesson learned: don’t get tunnel vision on macros — Office files are containers, and the “weird folder/file name” is often the clue.
      </p>
    </div>

    <div class="card">
      <h2>Tools Used</h2>
      <ul>
        <li>PowerPoint (quick recon + VBA editor)</li>
        <li><code>binwalk</code> (scan/extract embedded structure)</li>
        <li><code>unzip</code> (optional alternative extraction method)</li>
      </ul>
    </div>

    <footer>
      <p>Write-up by Andrew Li</p>
    </footer>
  </div>
</body>
</html>
